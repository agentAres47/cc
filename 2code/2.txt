drop table branch;
drop table Car;
drop table Customer;
drop table Rental_Fact;
drop table Time_Dim;


-- Customer Table
CREATE TABLE Customer (
    Customer_ID VARCHAR(10) PRIMARY KEY,
    Customer_Name VARCHAR(50),
    Gender VARCHAR(10),
    Contact_Number VARCHAR(15),
    City VARCHAR(30)
);

-- Car Table
CREATE TABLE Car (
    Car_ID VARCHAR(10) PRIMARY KEY,
    Car_Model VARCHAR(50),
    Car_Type VARCHAR(30),
    Daily_Rate DECIMAL(8,2)
);

-- Branch Table
CREATE TABLE Branch (
    Branch_ID VARCHAR(10) PRIMARY KEY,
    Branch_Name VARCHAR(50),
    Location VARCHAR(30),
    City VARCHAR(30)
);

-- Time Dimension Table
CREATE TABLE Time_Dim (
    Time_ID VARCHAR(10) PRIMARY KEY,
    Rental_Date DATE,
    Month VARCHAR(15),
    Year INT
);

-- Rental Fact Table
CREATE TABLE Rental_Fact (
    Rental_ID VARCHAR(10) PRIMARY KEY,
    Customer_ID VARCHAR(10),
    Car_ID VARCHAR(10),
    Branch_ID VARCHAR(10),
    Time_ID VARCHAR(10),
    Rental_Days INT,
    Total_Amount DECIMAL(10,2),

    FOREIGN KEY (Customer_ID) REFERENCES Customer(Customer_ID),
    FOREIGN KEY (Car_ID) REFERENCES Car(Car_ID),
    FOREIGN KEY (Branch_ID) REFERENCES Branch(Branch_ID),
    FOREIGN KEY (Time_ID) REFERENCES Time_Dim(Time_ID)
);


INSERT INTO Customer (Customer_ID, Customer_Name, Gender, Contact_Number, City)
VALUES
('C001', 'Rahul Sharma', 'Male', '9876543210', 'Mumbai'),
('C002', 'Priya Verma', 'Female', '9123456780', 'Delhi'),
('C003', 'Amit Kumar', 'Male', '9988776655', 'Bangalore'),
('C004', 'Sara Khan', 'Female', '9090909090', 'Hyderabad');

INSERT INTO Car (Car_ID, Car_Model, Car_Type, Daily_Rate)
VALUES
('CAR01', 'Honda City', 'Sedan', 2500.00),
('CAR02', 'Hyundai Creta', 'SUV', 3200.00),
('CAR03', 'Maruti Swift', 'Hatchback', 1800.00),
('CAR04', 'Toyota Fortuner', 'SUV', 5500.00);


INSERT INTO Branch (Branch_ID, Branch_Name, Location, City)
VALUES
('B01', 'Mumbai Central Branch', 'Central', 'Mumbai'),
('B02', 'Delhi South Branch', 'South', 'Delhi'),
('B03', 'Whitefield Branch', 'Whitefield', 'Bangalore');


INSERT INTO Time_Dim (Time_ID, Rental_Date, Month, Year)
VALUES
('T001', '2024-01-15', 'January', 2024),
('T002', '2024-02-10', 'February', 2024),
('T003', '2024-03-05', 'March', 2024),
('T004', '2024-04-22', 'April', 2024);


INSERT INTO Rental_Fact
(Rental_ID, Customer_ID, Car_ID, Branch_ID, Time_ID, Rental_Days, Total_Amount)
VALUES
('R001', 'C001', 'CAR01', 'B01', 'T001', 5, 12500.00),
('R002', 'C002', 'CAR03', 'B02', 'T002', 3, 5400.00),
('R003', 'C003', 'CAR04', 'B03', 'T004', 2, 11000.00),
('R004', 'C004', 'CAR02', 'B01', 'T003', 4, 12800.00);