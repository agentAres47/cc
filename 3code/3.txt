------------------------------------------------------
-- 1. CREATE TABLE
------------------------------------------------------
CREATE TABLE Sales (
    Sales_ID INT PRIMARY KEY,
    Product_ID INT,
    Region VARCHAR(50),
    Year INT,
    Quarter INT,
    Sales_Amount DECIMAL(10,2)
);

------------------------------------------------------
-- 2. INSERT VALUES
------------------------------------------------------
INSERT INTO Sales (Sales_ID, Product_ID, Region, Year, Quarter, Sales_Amount)
VALUES
(1, 101, 'North', 2024, 1, 15000.00),
(2, 101, 'South', 2024, 1, 12000.00),
(3, 102, 'East',  2024, 2, 18000.00),
(4, 103, 'West',  2024, 2, 16000.00),
(5, 101, 'North', 2023, 3, 14000.00),
(6, 102, 'South', 2023, 4, 11000.00),
(7, 103, 'East',  2023, 1, 17000.00),
(8, 101, 'West',  2023, 3, 15500.00);

------------------------------------------------------
-- 3. QUERY 1: REGION, YEAR, QUARTER TOTAL SALES (ROLLUP)
------------------------------------------------------
SELECT 
    Region,
    Year,
    Quarter,
    SUM(Sales_Amount) AS Total_Sales
FROM Sales
GROUP BY Region, Year, Quarter WITH ROLLUP;

------------------------------------------------------
-- 4. QUERY 2: REGION + QUARTER TOTALS FOR YEAR 2024
------------------------------------------------------
SELECT 
    Region,
    Quarter,
    SUM(Sales_Amount) AS Total_Sales
FROM Sales
WHERE Year = 2024
GROUP BY Region, Quarter;

------------------------------------------------------
-- 5. QUERY 3: PIVOT-LIKE YEARLY SALES BY REGION
------------------------------------------------------
SELECT 
    Year,
    SUM(CASE WHEN Region = 'North' THEN Sales_Amount ELSE 0 END) AS North_Sales,
    SUM(CASE WHEN Region = 'South' THEN Sales_Amount ELSE 0 END) AS South_Sales,
    SUM(CASE WHEN Region = 'East'  THEN Sales_Amount ELSE 0 END) AS East_Sales,
    SUM(CASE WHEN Region = 'West'  THEN Sales_Amount ELSE 0 END) AS West_Sales
FROM Sales
GROUP BY Year;

------------------------------------------------------
-- 6. QUERY 4: REGION-YEAR-QUARTER SUMMARY WITH ROLLUP
------------------------------------------------------
SELECT 
    Region,
    Year,
    Quarter,
    SUM(Sales_Amount) AS Total_Sales
FROM Sales
GROUP BY Region, Year, Quarter WITH ROLLUP;